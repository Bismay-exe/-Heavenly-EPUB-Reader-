<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Heavenly EPUB Reader</title>
  <link rel="stylesheet" href="style.css" />
  <!-- Libraries via CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/epubjs@0.3/dist/epub.min.js"></script>
</head>
<body>
  <header>
    <h1>📖 Heavenly EPUB Reader</h1>
    <nav>
      <a href="dashboard.html">📊 Dashboard</a>
      <button id="downloadAllBtn">📦 Download All</button>
      <input type="file" id="restoreZipInput" accept=".zip" hidden />
      <button id="restoreZipBtn">🔄 Restore from ZIP</button>
    </nav>
  </header>

  <main>
    <!-- Progress UI shared for backup/restore -->
    <div id="restoreProgress" style="display:none;">
      <div id="progressBar"></div>
      <p id="progressText">Processing...</p>
      <button id="pauseResumeBtn">⏸ Pause</button>
      <button id="cancelProgress">❌ Cancel</button>
    </div>

    <!-- Bookshelf -->
    <section id="bookshelf">
      <h2>📚 My Books</h2>

      <div id="continueReading" class="hidden">
        <button id="continueBtn">📖 Continue Reading</button>
        <p id="continueTitle"></p>
      </div>

      <div id="bookshelfActions">
        <button id="clearAllBtn">🗑️ Clear All Books</button>
        <button id="exportBtn">⬇️ Export Bookshelf (JSON)</button>
        <button id="importBtn">⬆️ Import Bookshelf (JSON)</button>
        <input type="file" id="importFile" accept=".json" style="display:none" />
      </div>

      <div id="bookList" class="grid"></div>
      <input type="file" id="fileInput" accept=".epub" />
    </section>

    <!-- Reader -->
    <section id="reader-container" class="hidden">
      <div id="viewer"></div>
      <div id="controls">
        <button id="prevBtn">⬅ Prev</button>
        <button id="nextBtn">Next ➡</button>
        <button id="backBtn">📚 Back to Bookshelf</button>

        <!-- Floating Settings & Stats -->
        <button id="openSettings" class="floating-btn" title="Settings">⚙️</button>
        <button id="openStats" class="floating-btn" style="right: 80px;" title="Stats">📊</button>
      </div>
    </section>
  </main>

  <!-- Settings Panel -->
  <div id="settingsPanel" class="overlay glass hidden">
    <div class="overlay-content">
      <h2>⚙️ Reader Settings</h2>

      <label>📏 Font Size</label>
      <input type="range" id="fontSizeSlider" min="14" max="28" value="18" />

      <label>📐 Line Height</label>
      <input type="range" id="lineHeightSlider" min="1" max="2" step="0.1" value="1.5" />

      <label>🎨 Theme</label>
      <select id="themeSelect">
        <option value="light">☀️ Light</option>
        <option value="dark">🌙 Dark</option>
        <option value="sepia">📜 Sepia</option>
      </select>

      <div style="margin-top: 1.2rem; text-align:center;">
        <button id="closeSettings">Close</button>
      </div>
    </div>
  </div>

  <!-- Stats Panel -->
  <div id="statsPanel" class="overlay glass hidden">
    <div class="overlay-content">
      <h2>📊 Reading Stats</h2>
      <ul>
        <li>⏳ Time Spent: <span id="timeSpent">0 min</span></li>
        <li>📖 Pages Read: <span id="pagesRead">0</span></li>
        <li>🔢 Total Pages: <span id="totalPages">0</span></li>
        <li>📊 Progress: <span id="progressPercent">0%</span></li>
        <li>⌛ Time Left (Est.): <span id="timeLeft">0 min</span></li>
      </ul>
      <button id="closeStats">Close</button>
    </div>
  </div>

  <script src="js/db.js"></script>
  <script src="js/reader-settings.js" defer></script>
</body>
</html>
